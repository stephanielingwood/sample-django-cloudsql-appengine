language: python

python:
  - 2.7

services:
  - mysql

env:
  global:
    # - GAE_DIR=/tmp/gae
    # the following secure variable is the json key for the app engine project's service account
    - secure: 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

build:
  ci:
    # - echo $GAE_DIR
    # - >
    #   test -e $GAE_DIR ||
    #   (mkdir -p $GAE_DIR &&
    #   wget https://storage.googleapis.com/appengine-sdks/featured/google_appengine_1.9.35.zip -q -O /tmp/gae.zip &&
    #   unzip /tmp/gae.zip -d $GAE_DIR)
    - pip install -r requirements.txt
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - coverage run manage.py test
  on_success:
    - echo 'yay'
    # - echo "$GAE_PASSWORD" | $GAE_DIR/google_appengine/appcfg.py -e "$EMAIL" -A "testgkeproject-1181" --noisy list_versions
    - supress=$(echo $SERVICE_ACCOUNT_KEY > /tmp/key.json)
    - gcloud -q auth activate-service-account --verbosity=debug --key-file /tmp/key.json
    - gcloud config set project testgkeproject-1181
    - gcloud config list
    - sudo apt-get install tree
    - tree $SHIPPABLE_REPO_DIR
    - gcloud preview app deploy $SHIPPABLE_REPO_DIR/app.yaml



